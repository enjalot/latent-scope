<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>50,000 U.S. Federal Laws | Latent Scope</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_import/components/scatter.e6a504c8.js">
<link rel="modulepreload" href="./_import/components/hull.f981bcf2.js">
<link rel="modulepreload" href="./_import/components/dynamicHull.09110e6a.js">
<link rel="modulepreload" href="./_import/components/tooltip.c593267a.js">
<link rel="modulepreload" href="./_import/components/clusterCard.eba8a284.js">
<link rel="modulepreload" href="./_import/components/clusterListCard.2bd231cb.js">
<link rel="modulepreload" href="./_node/markdown-it@14.0.0/index.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/regl-scatterplot@1.8.5/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.14/_esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@16.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/parquet-wasm@0.6.0/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/duckdb.js">
<link rel="modulepreload" href="./_npm/@duckdb/duckdb-wasm@1.28.0/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_node/mdurl@2.0.0/index.js">
<link rel="modulepreload" href="./_node/uc.micro@2.1.0/index.js">
<link rel="modulepreload" href="./_node/entities@4.5.0/index.js">
<link rel="modulepreload" href="./_node/linkify-it@5.0.0/index.js">
<link rel="modulepreload" href="./_node/punycode.js@2.3.1/index.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/pub-sub-es@2.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/regl@2.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/tslib@2.6.2/_esm.js">
<link rel="modulepreload" href="./_npm/flatbuffers@23.5.26/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/us-federal-laws/Civil Rights.indices", {"name":"./data/us-federal-laws/Civil Rights.indices","path":"./_file/data/us-federal-laws/Civil Rights.82bbb438.indices","lastModified":1715186462386});
registerFile("./data/us-federal-laws/scopes-001-input.parquet", {"name":"./data/us-federal-laws/scopes-001-input.parquet","path":"./_file/data/us-federal-laws/scopes-001-input.6e83fc83.parquet","lastModified":1714964112377});
registerFile("./data/us-federal-laws/scopes-001.json", {"name":"./data/us-federal-laws/scopes-001.json","mimeType":"application/json","path":"./_file/data/us-federal-laws/scopes-001.9ebaeb56.json","lastModified":1714776026270});

define({id: "8b015fb7", inline: true, inputs: ["min","da","display"], body: async (min,da,display) => {
display(await(
min(da, d => d.date_of_passage).split("-")[0]
))
}});

define({id: "78da89e5", inline: true, inputs: ["max","da","display"], body: async (max,da,display) => {
display(await(
max(da, d => d.date_of_passage).split("-")[0]
))
}});

define({id: "271f1a63", inline: true, inputs: ["Inputs","da","tableConfig","display"], body: async (Inputs,da,tableConfig,display) => {
display(await(
Inputs.table(da, tableConfig)
))
}});

define({id: "8ff0b1db", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData.length
))
}});

define({id: "c133b744", inline: true, inputs: ["da","display"], body: async (da,display) => {
display(await(
da.length
))
}});

define({id: "8ff0b1db-1", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData.length
))
}});

define({id: "820662af", inputs: ["scope","da","min","max","view","Inputs"], outputs: ["clusterTableData","selclusterTable"], body: (scope,da,min,max,view,Inputs) => {
const clusterTableData = scope.cluster_labels_lookup.map(c => {
  let dc = da.filter(d => d.cluster == c.cluster)
  return {
    cluster: c.cluster,
    label: c.label,
    count: dc.length,
    min_date: min(dc, d => d.date_of_passage),
    max_date: max(dc, d => d.date_of_passage),
  }
})
const selclusterTable = view(Inputs.table(clusterTableData, {
  width: {
    cluster: 40,
  },
  header: {
    "cluster": ""
  },
  sort: "min_date",
  reverse: false,
  multiple: false,
  value: clusterTableData[271]
}))
return {clusterTableData,selclusterTable};
}});

define({id: "7bd5ce0e", inputs: ["view","dynamicHull","hulls","selclusterTable"], outputs: ["dynahull"], body: (view,dynamicHull,hulls,selclusterTable) => {
const dynahull = view(dynamicHull(hulls, {
  width: 500,
  height: 500,
  xd: [-1.1, 1.1],
  yd: [-1.1, 1.1],
  selected: selclusterTable.cluster
}))
return {dynahull};
}});

define({id: "97380187", inline: true, inputs: ["tip","display"], body: async (tip,display) => {
display(await(
tip
))
}});

define({id: "399e02b8", inputs: ["htl","clusterTableData"], outputs: ["clusterDescription"], body: (htl,clusterTableData) => {
function clusterDescription (cluster) {
  return htl.html`<div>
   <span style="border-bottom: 2px solid lightblue">favorites: ${clusterTableData[cluster].favorites}</span>
   <br/>
   <br/>
   <span style="border-bottom: 2px solid orange">retweets: ${clusterTableData[cluster].retweets}</span>
  </div>`
}
return {clusterDescription};
}});

define({id: "cd3c3091", inline: true, inputs: ["clusterCard","dynahull","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterCard,dynahull,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(dynahull.selected, {
    description: "",
    plot: dateBars(dynahull.selected),
    tableConfig, 
    da, 
    scope, 
    hulls,
    r: 1
  })
))
}});

define({id: "7c77363a", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData[10].label
))
}});

define({id: "7c77363a-1", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData[10].label
))
}});

define({id: "9106fb3f", inline: true, inputs: ["clusterCard","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterCard,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(10, {
    plot: "You used to have to ask Uncle Sam to name your boat?", 
    description: dateBars(10),
    tableConfig, 
    da, 
    scope, 
    hulls,
    r: 1
  })
))
}});

define({id: "24b77842", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData[59].label
))
}});

define({id: "24b77842-1", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData[59].label
))
}});

define({id: "40cf29c3", inline: true, inputs: ["clusterCard","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterCard,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(59, {
    plot: "This is a lot to be aware of...", 
    description: dateBars(59),
    tableConfig, 
    da, 
    scope, 
    hulls,
    r: 1
  })
))
}});

define({id: "e1454b87", inline: true, inputs: ["da","display"], body: async (da,display) => {
display(await(
da.filter(d => d.date_of_passage?.indexOf("1914-05") == 0).length
))
}});

define({id: "47a8cd0e", inline: true, inputs: ["Inputs","da","tableConfig","display"], body: async (Inputs,da,tableConfig,display) => {
display(await(
Inputs.table(da.filter(d => d.date_of_passage?.indexOf("1914-05") == 0), tableConfig)
))
}});

define({id: "9d3d6299", inline: true, inputs: ["clusterTableData","display"], body: async (clusterTableData,display) => {
display(await(
clusterTableData[189].label
))
}});

define({id: "8e6240f1", inline: true, inputs: ["clusterCard","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterCard,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(189, {
    description: "", 
    plot: dateBars(189),
    tableConfig, 
    da, 
    scope, 
    hulls,
    r: 1
  })
))
}});

define({id: "f8b269cb", outputs: ["bridgeClusters"], body: () => {
const bridgeClusters = [72, 73, 74, 75, 76, 77, 79, 80,81, 83, 85, 88, 89, 90, 91, 92, 93, 97, 98]
return {bridgeClusters};
}});

define({id: "3033a122", inline: true, inputs: ["clusterListCard","bridgeClusters","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterListCard,bridgeClusters,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterListCard(bridgeClusters, {
    heading: "Bridge Building",
    plot: dateBars(bridgeClusters),
    tableConfig: {...tableConfig, columns: ["Title", "date_of_passage", "cluster", "label"], 
      width: { Title: "70%", date_of_passage: 100, cluster: 40, label: 170}, sort: "cluster"},
    da, 
    scope, 
    hulls 
})
))
}});

define({id: "dcd871c6", outputs: ["dcClusters"], body: () => {
const dcClusters = [123, 106, 107, 109, 110, 111, 112, 114, 116, 118, 119]
return {dcClusters};
}});

define({id: "983230ef", inline: true, inputs: ["clusterListCard","dcClusters","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterListCard,dcClusters,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterListCard(dcClusters, {
    heading: "Washington D.C.",
    plot: dateBars(dcClusters),
    tableConfig: {...tableConfig, columns: ["Title", "date_of_passage", "cluster", "label"], width: { Title: "70%", date_of_passage: 100, cluster: 40, label: 170}},
    da, 
    scope, 
    hulls 
})
))
}});

define({id: "aff71acf", outputs: ["naClusters"], body: () => {
const naClusters = [105, 127, 141, 146,  178, 183, 190, 204, 205, 210, 211]
return {naClusters};
}});

define({id: "79bf1aa4", inline: true, inputs: ["clusterListCard","naClusters","dateBars","tableConfig","da","scope","hulls","display"], body: async (clusterListCard,naClusters,dateBars,tableConfig,da,scope,hulls,display) => {
display(await(
clusterListCard(naClusters, {
    heading: "Native American",
    plot: dateBars(naClusters),
    tableConfig: {...tableConfig, columns: ["Title", "date_of_passage", "cluster", "label"], width: { Title: "70%", date_of_passage: 100, cluster: 40, label: 170}},
    da, 
    scope, 
    hulls 
})
))
}});

define({id: "e16e65c2", inputs: ["FileAttachment","da"], outputs: ["civilRights"], body: async (FileAttachment,da) => {
const civilRights = (await FileAttachment("./data/us-federal-laws/Civil Rights.indices").text()).split("\n").map(d => da.find(p => p.index == +d))
return {civilRights};
}});

define({id: "c042747d", inputs: ["Plot","hulls","civilRights","display"], body: async (Plot,hulls,civilRights,display) => {
display(await(
 Plot.plot({
        marks: [
          Plot.hull(hulls.flatMap(d => d), {
            x: "x",
            y: "y",
            fill: "cluster",
            fillOpacity: 0.1,
            stroke: "lightgray",
            curve: "catmull-rom",
          }),
          
          Plot.dot(civilRights, {
            x: "x",
            y: "y",
            fill: "cluster",
            title: d => `${d.Title}\n${d.date_of_passage}\n${d.cluster}: ${d.label}`,
            tip: true
          }),
        ],
        width: 500,
        height: 500,
        color: { scheme: "cool" },
        y: { axis: null},
        x: { axis: null },
        tip: {
          format: {
            cluster: true,
            title: true,
            date_of_passage: true
          }
        }
      })
))
}});

define({id: "60c87720", inline: true, inputs: ["Inputs","civilRights","tableConfig","display"], body: async (Inputs,civilRights,tableConfig,display) => {
display(await(
Inputs.table(civilRights, 
      {...tableConfig, columns: ["Title", "date_of_passage", "cluster", "label"], width: { Title: "70%", date_of_passage: 100, cluster: 40, label: 170}}
    )
))
}});

define({id: "de076962", body: () => {
// const map = view(canvas)
}});

define({id: "08e9e9b6", inputs: ["tooltip"], outputs: ["tip"], body: (tooltip) => {
const tip = tooltip({})
return {tip};
}});

define({id: "b9443a04", body: () => {
// let hp = da[map.hovered[0]]
}});

define({id: "17d14ae0", inputs: ["dynahull","mean","hulls","tip","md","min","max","da"], body: (dynahull,mean,hulls,tip,md,min,max,da) => {
if(dynahull.hovered >= 0){
  // display the tooltip
  // console.log("p, sel", p, selected)
  // calculate the hull centroid
  let h = dynahull.hovered
  let x = mean(hulls[h], d => d.x)
  let y = mean(hulls[h], d => d.y)
  let hp = {...hulls[h][0], x, y}
  tip.show(hp, {width: 500, height: 500, xd: [-1.1, 1.1], yd: [-1.1, 1.1]}, md.unsafe(`
  <i>Cluster ${hp["cluster"]}: ${hp["label"]}</i>
  <br/>
  <span>${min(hulls[h], d => d["date_of_passage"])} - ${max(hulls[h], d => d["date_of_passage"])}</span>
  <br/>
  ${da.filter(d => d.cluster == h).length} laws
  `))
} else {
  tip.hide()
}
}});

define({id: "3fa829a8", outputs: ["tableConfig"], body: () => {
const tableConfig = { 
  columns: [
    "Title",
    "date_of_passage",
  ],
  width: {
    "Title": "80%"
  },
  sort: "date_of_passage",
  reverse: false,
  rows: 15
}
return {tableConfig};
}});

define({id: "b0028f22", body: () => {
// const canvas = document.createElement("canvas")
}});

define({id: "520ae0fa", body: () => {
// let tableData = []
// if(map.selected.length > 0) {
//   // tableData = []
//   map.selected.forEach(i => tableData.push(da[i]))
// }
}});

define({id: "06bd66db", inputs: ["scope","da"], outputs: ["hulls"], body: (scope,da) => {
// calculate the hull points
const hulls = scope.cluster_labels_lookup.map(c => {
  return c.hull.map(idx => da.find(d => d.index === idx))
})
return {hulls};
}});

define({id: "881df1e0", inputs: ["Plot","da"], outputs: ["dateBars"], body: (Plot,da) => {
function dateBars(cluster) {
  let filter = d => d.cluster == cluster
  if (Array.isArray(cluster)) {
    filter = d => cluster.indexOf(d.cluster) >= 0
  }
  return Plot.plot({
    marks: [
      Plot.barX(da, Plot.binY({x: "count"}, {
        filter,
        y: d => new Date(d["date_of_passage"]).getFullYear(),
        x: "count",
      }))
    ],
    marginLeft: 80,
    marginBottom: 30,
    width: 300,
    height: 300,
    y: { label: null, tickFormat: x => Math.floor(x).toString() },
    x: { label: null },
    // style: { "background-color": "white" }
  })
}
return {dateBars};
}});

define({id: "b1d51dcc", inputs: ["DuckDBClient","FileAttachment"], outputs: ["db"], body: (DuckDBClient,FileAttachment) => {
const db = DuckDBClient.of({
  scope: FileAttachment("./data/us-federal-laws/scopes-001-input.parquet")
});
return {db};
}});

define({id: "5076ebc7", inputs: ["FileAttachment"], outputs: ["scope"], body: (FileAttachment) => {
const scope = FileAttachment("./data/us-federal-laws/scopes-001.json").json()
return {scope};
}});

define({id: "4ff80698", inputs: ["db"], outputs: ["data"], body: (db) => {
// const rows = db.sql`SELECT * FROM input`
const data = db.sql`SELECT index,cluster,label,Title,date_of_passage,source,x,y FROM scope`
return {data};
}});

define({id: "0f267664", inputs: ["data"], outputs: ["da"], body: (data) => {
const da = data.toArray().map(d => d.toJSON())
return {da};
}});

define({id: "5551e850", inputs: ["da","scope","hulls"], body: (da,scope,hulls) => {
console.log("data!", da)
console.log("scope!", scope)
console.log("hulls!", hulls)
}});

define({id: "bf752053", outputs: ["scatter","hull","dynamicHull","tooltip","clusterCard","clusterListCard","markdownit","select","min","max","sum","mean"], body: async () => {
const [{scatter}, {hull}, {dynamicHull}, {tooltip}, {clusterCard}, {clusterListCard}, {default: markdownit}, {select}, {min, max, sum, mean}] = await Promise.all([import("./_import/components/scatter.e6a504c8.js"), import("./_import/components/hull.f981bcf2.js"), import("./_import/components/dynamicHull.09110e6a.js"), import("./_import/components/tooltip.c593267a.js"), import("./_import/components/clusterCard.eba8a284.js"), import("./_import/components/clusterListCard.2bd231cb.js"), import("./_node/markdown-it@14.0.0/index.js"), import("./_npm/d3-selection@3.0.0/_esm.js"), import("./_npm/d3-array@3.2.4/_esm.js")]);


return {scatter,hull,dynamicHull,tooltip,clusterCard,clusterListCard,markdownit,select,min,max,sum,mean};
}});

define({id: "2af7ab58", inputs: ["markdownit"], outputs: ["Markdown","md"], body: (markdownit) => {
const Markdown = new markdownit({html: true});

const md = {
  unsafe(string) {
    const template = document.createElement("template");
    template.innerHTML = Markdown.render(string);
    return template.content.cloneNode(true);
  }
};
return {Markdown,md};
}});

define({id: "5f76811e", outputs: ["isMobileDevice"], body: () => {
const isMobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
return {isMobileDevice};
}});

define({id: "74b5d617", inputs: ["isMobileDevice","select"], body: (isMobileDevice,select) => {
if(isMobileDevice) {
  select(".regl-container").style("display", "none")
}
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Latent Scope</a></li>
  </ol>
  <ol>
    <section>
      <summary>Guides</summary>
      <ol>
    <li class="observablehq-link"><a href="./install-and-config">Install &amp; Configure</a></li>
    <li class="observablehq-link"><a href="./your-first-scope">Your First Scope</a></li>
    <li class="observablehq-link"><a href="./explore-and-curate">Explore and Curate</a></li>
    <li class="observablehq-link"><a href="./exporting-data">Exporting data</a></li>
      </ol>
    </section>
    <section class="observablehq-section-active">
      <summary>Example Analysis</summary>
      <ol>
    <li class="observablehq-link"><a href="./datavis-survey">Datavis Survey</a></li>
    <li class="observablehq-link"><a href="./plot-issues">GitHub Issues &amp; PRs</a></li>
    <li class="observablehq-link"><a href="./enjalot-tweets">enjalot&#x27;s tweets</a></li>
    <li class="observablehq-link observablehq-link-active"><a href="./us-federal-laws">US Federal Laws</a></li>
      </ol>
    </section>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<header id="observablehq-header">

  <!-- Google tag (gtag.js) -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W8EM95KSJZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-W8EM95KSJZ');
  </script>
  
  <link rel="stylesheet" type="text/css" href="./_file/index.2730b0b3.css">
  <div style="display: flex; align-items: center; gap: 0.5rem; height: 2.2rem; margin: -1.5rem -2rem 2rem -2rem; padding: 0.5rem 2rem; border-bottom: solid 1px var(--theme-foreground-faintest); font: 500 16px var(--sans-serif);">
    <div style="display: flex; flex-grow: 1; justify-content: space-between; align-items: baseline;">
      <a href="./">
        Latent Scope
      </a>
      <span style="display: flex; align-items: baseline; gap: 0.5rem; font-size: 14px;">
        <a target="_blank" href="https://github.com/enjalot/latent-scope" rel="noopener noreferrer">GitHub</a>
        <a target="_blank" href="https://pypi.org/project/latentscope/" rel="noopener noreferrer">Python Module</a>
        <a target="_blank" href="https://discord.gg/x7NvpnM4pY" rel="noopener noreferrer">Discord</a>
        
        <a target="_blank" href="https://github.com/enjalot/latent-scope-observable-examples" rel="noopener noreferrer">Examples Source</a>
      </span>
    </div>
  </div>
</header>
<main id="observablehq-main" class="observablehq">
<h1 id="50%2C000-u.s.-federal-laws" tabindex="-1"><a class="observablehq-header-anchor" href="#50%2C000-u.s.-federal-laws">50,000 U.S. Federal Laws</a></h1>
<p>This <a href="https://osf.io/mrghc/?view_only" target="_blank" rel="noopener noreferrer">fascinating dataset</a> contains the titles and dates of almost 50,000 U.S. federal laws from <span id="cell-8b015fb7" class="observablehq--loading"></span> to <span id="cell-78da89e5" class="observablehq--loading"></span>.
I was made aware of this dataset in the <a href="https://www.data-is-plural.com/archive/2024-02-28-edition/" target="_blank" rel="noopener noreferrer">Data is Plural 2024.02.28 edition</a>, a great place to find interesting public datasets.</p>
<p>The 49,746 laws:</p>
<div class="input-card">
<div class="static-table">
<span id="cell-271f1a63" class="observablehq--loading"></span>
</div>
</div>
<p>As you might imagine, 50k laws is a lot to sort through.
We can use <a href="https://github.com/enjalot/latent-scope" target="_blank" rel="noopener noreferrer">Latent Scope</a> to organize them by the similarity of their titles and see what clusters of laws emerge.
This article takes you through a short tour of these clusters, stopping at some really funny laws as well as some deadly serious laws.</p>
<p>Before we explore, I want to give a short preview of what Latent Scope is, you can get a full tutoria on <a href="your-first-scope">building your own scope</a> but this is the interface you would work with to curate your clusters in the tool:</p>
<img src="./_file/assets/us-federal-laws/explore.a08693bc.png" class="pageshot">
<p>Latent scope helps you put your data through a <a href="your-first-scope">4 step process</a>:</p>
<img src="./_file/assets/us-federal-laws/setup.584d7ee9.png" class="screenshot">
<ol>
<li>Embed - run each piece of text through an embedding model</li>
<li>Project - run the high-dimensional embeddings through UMAP</li>
<li>Cluster - run the 2-dimensional UMAP coordinates through HDBSCAN</li>
<li>Label - ask an LLM to create a label by summarizing a list of text taken from each cluster</li>
</ol>
<p>So at the end of this process we have <span id="cell-8ff0b1db" class="observablehq--loading"></span> clusters carving up our <span id="cell-c133b744" class="observablehq--loading"></span> laws, with<br>
every row of our input data annotated with a cluster index and label.
In our other example analyses like <a href="datavis-survey">Datavis Survey</a> and <a href="enjalot-tweets">enjalot's tweets</a> we didn't have quite so many data points.
50,000 isn't enormous, Latent Scope can easily work with a million on an average computer, but it is still a lot of points to plot.</p>
<p>So in this analysis we will focus on exploring the <span id="cell-8ff0b1db-1" class="observablehq--loading"></span> clusters, showing the individual laws in each cluster only when you select a cluster.
Feel free to peruse the clusters in this interface, if you keep scrolling I'll take you on a tour of the ones I find most interesting!</p>
<p><em>Click on the radio button on the left of each cluster in the table, or click on a cluster in the map to select it and see the details in the card below</em></p>
<div class="input-card" style="border: 1px solid lightgray; border-radius: 5px; padding: 10px;">
<div id="cell-820662af" class="observablehq observablehq--block"></div>
<div style="position:relative;">
<div id="cell-7bd5ce0e" class="observablehq observablehq--block"></div>
  <div>
    <span id="cell-97380187" class="observablehq--loading"></span>
  </div>
</div>
</div>
<div id="cell-399e02b8" class="observablehq observablehq--block"></div>
<div>
  <span id="cell-cd3c3091" class="observablehq--loading"></span>
</div>
<br>
<h2 id="" tabindex="-1"><a class="observablehq-header-anchor" href="#"><span id="cell-7c77363a" class="observablehq--loading"></span></a></h2>
<p>The cluster that jumped out at me when I was first browsing the data is <strong><span id="cell-7c77363a-1" class="observablehq--loading"></span></strong>.
Seeing laws with a title like
<em>"To change the name of the schooner Sally McGee to that of Ocean Eagle"</em> and
<em>"To authorize the Secretary of the Treasury to change the name of the steam yacht "Fanny."</em> made me wonder what was going on in the 1800s.
It seems like back then you even had to get Congress to help you fix a typo in your boat name: <em>"	To change the name of the schooner La Pette to La Petite."</em></p>
<div>
  <span id="cell-9106fb3f" class="observablehq--loading"></span>
</div>
<br>
<h2 id="-1" tabindex="-1"><a class="observablehq-header-anchor" href="#-1"><span id="cell-24b77842" class="observablehq--loading"></span></a></h2>
<p>Another fun cluster is <strong><span id="cell-24b77842-1" class="observablehq--loading"></span></strong>.
Were you aware that since 1962 the U.S. has had a "an annual National School Lunch Week"?
There are over 600 National awareness related laws in this cluster!</p>
<div>
  <span id="cell-40cf29c3" class="observablehq--loading"></span>
</div>
<p>I also found the <em>"Joint resolution to designate the third Sunday in June 1966 as Father's Day"</em>, which made me curious about when Mother's day was establshed.
I believe this dataset is missing the <a href="https://en.wikipedia.org/wiki/Mother%27s_Day_(United_States)#Establishment_of_holiday" target="_blank" rel="noopener noreferrer">1914 law</a> passed by U.S. Congress to make it official.</p>
<p>Here are the <span id="cell-e1454b87" class="observablehq--loading"></span> laws in the dataset passed in May of 1914:</p>
<div class="input-card">
<span id="cell-47a8cd0e" class="observablehq--loading"></span>
</div>
<p>When dealing with a lot of data, small data quality issues can be hard to find.
Being able to explore the data by through the meaningful groupings of the clusters is a great way to ask questions you didn't know you had!</p>
<h2 id="u.s.-land-legislation" tabindex="-1"><a class="observablehq-header-anchor" href="#u.s.-land-legislation">U.S. Land Legislation</a></h2>
<p>An interesting and a bit more serious cluster is <strong><span id="cell-9d3d6299" class="observablehq--loading"></span></strong>.
Can you find laws related the Louisiana Purchase around 1803?</p>
<div>
  <span id="cell-8e6240f1" class="observablehq--loading"></span>
</div>
<h2 id="bridge-building" tabindex="-1"><a class="observablehq-header-anchor" href="#bridge-building">Bridge Building</a></h2>
<p>There are more than 3,000 laws related to bridge building and dam construction across 19 clusters.
Sometimes the embedding model finds patterns in text that are more subtle than a high level concept such as bridges and dams.
Investigating what the different patterns in each cluster are could lead to interesting insights (if you care about bridges and dams!)</p>
<div id="cell-f8b269cb" class="observablehq observablehq--block"></div>
<div>
<span id="cell-3033a122" class="observablehq--loading"></span>
</div>
<p>Another thing to notice about those bridge building clusters is that a lot of those laws were passed in the early 20th century, with a peak in the late 1920s and early 1930s.
This is also around the time that the Golden Gate Bridge began construction, so we must have really been into bridges at that time.</p>
<h2 id="washington-d.c." tabindex="-1"><a class="observablehq-header-anchor" href="#washington-d.c.">Washington D.C.</a></h2>
<p>What does Congress love almost as much as building bridges? Washington D.C.!
With over 5% of the laws in the dataset found in the Washington D.C. cluster, you can tell they really care about it.</p>
<div id="cell-dcd871c6" class="observablehq observablehq--block"></div>
<div>
<span id="cell-983230ef" class="observablehq--loading"></span>
</div>
<br>
<h2 id="native-americans" tabindex="-1"><a class="observablehq-header-anchor" href="#native-americans">Native Americans</a></h2>
<p>There are also quite a few laws relating to our sad history with Native Americans.</p>
<div id="cell-aff71acf" class="observablehq observablehq--block"></div>
<div>
<span id="cell-79bf1aa4" class="observablehq--loading"></span>
</div>
<br>
<h2 id="civil-rights" tabindex="-1"><a class="observablehq-header-anchor" href="#civil-rights">Civil Rights</a></h2>
<p>I wasn't able to identify clusters that related specifically to civil rights, but thanks to the embeddings I was able to use nearest neighbor search to find 150 laws that are related to the concept of civil rights.</p>
<div id="cell-e16e65c2" class="observablehq observablehq--block"></div>
<div class="card">
<div id="cell-c042747d" class="observablehq observablehq--block observablehq--loading"></div>
  <div class="static-table">
    <span id="cell-60c87720" class="observablehq--loading"></span>
  </div>
</div>
<p>Nearest neighbor search on embeddings is what powers techniques like Retrieval Augmented Generation (RAG), finding relevant documents to feed to an LLM as context for a query.
In the above visualization we can see that the similarity search on the query of "civil rights" returns laws that are mostly relevant but also spread across various clusters.
What would it be like to leverage the clustering to determine relevance when implementing techniques like RAG?</p>
<p>Interested in running your own large text dataset through Latent Scope? Try out <a href="your-first-scope">the getting started tutorial</a> and reach out on <a href="https://discord.gg/x7NvpnM4pY" target="_blank" rel="noopener noreferrer">Discord</a> if you run into any issues!</p>
<div id="cell-de076962" class="observablehq observablehq--block"></div>
<div id="cell-08e9e9b6" class="observablehq observablehq--block"></div>
<div id="cell-b9443a04" class="observablehq observablehq--block"></div>
<div id="cell-17d14ae0" class="observablehq observablehq--block"></div>
<div id="cell-3fa829a8" class="observablehq observablehq--block"></div>
<div id="cell-b0028f22" class="observablehq observablehq--block"></div>
<div id="cell-520ae0fa" class="observablehq observablehq--block"></div>
<div id="cell-06bd66db" class="observablehq observablehq--block"></div>
<div id="cell-881df1e0" class="observablehq observablehq--block"></div>
<div id="cell-b1d51dcc" class="observablehq observablehq--block"></div>
<div id="cell-5076ebc7" class="observablehq observablehq--block"></div>
<div id="cell-4ff80698" class="observablehq observablehq--block"></div>
<div id="cell-0f267664" class="observablehq observablehq--block"></div>
<div id="cell-5551e850" class="observablehq observablehq--block"></div>
<div id="cell-bf752053" class="observablehq observablehq--block"></div>
<div id="cell-2af7ab58" class="observablehq observablehq--block"></div>
<div id="cell-5f76811e" class="observablehq observablehq--block"></div>
<div id="cell-74b5d617" class="observablehq observablehq--block"></div>
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./enjalot-tweets"><span>enjalot&#x27;s tweets</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-05-08T13:39:15">May 8, 2024</a>.</div>
</footer>
</div>
