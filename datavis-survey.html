<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Datavis Survey Analysis | Latent Scope</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_import/components/scatter.e6a504c8.js">
<link rel="modulepreload" href="./_import/components/hull.f981bcf2.js">
<link rel="modulepreload" href="./_import/components/tooltip.c593267a.js">
<link rel="modulepreload" href="./_import/components/clusterCard.eba8a284.js">
<link rel="modulepreload" href="./_npm/regl-scatterplot@1.8.5/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@observablehq/plot@0.6.14/_esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@16.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/parquet-wasm@0.6.0/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/duckdb.js">
<link rel="modulepreload" href="./_npm/@duckdb/duckdb-wasm@1.28.0/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_npm/pub-sub-es@2.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/regl@2.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_npm/interval-tree-1d@1.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/tslib@2.6.2/_esm.js">
<link rel="modulepreload" href="./_npm/flatbuffers@23.5.26/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/binary-search-bounds@2.0.5/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile} from "./_observablehq/stdlib.js";

registerFile("./data/datavis-survey/scopes-001-input.parquet", {"name":"./data/datavis-survey/scopes-001-input.parquet","path":"./_file/data/datavis-survey/scopes-001-input.b9718cf2.parquet","lastModified":1714675430620});
registerFile("./data/datavis-survey/scopes-001.json", {"name":"./data/datavis-survey/scopes-001.json","mimeType":"application/json","path":"./_file/data/datavis-survey/scopes-001.d44da6f0.json","lastModified":1714675430621});

define({id: "1b1151e3", inline: true, inputs: ["Inputs","da","display"], body: async (Inputs,da,display) => {
display(await(
Inputs.table(da, { 
        columns: [
          "DataVizNotUnderstood",
          "Role",
        ],
        width: {
          "DataVizNotUnderstood": "70%",
        },
        rows:10 
      })
))
}});

define({id: "9577b65f", inputs: ["Plot","hulls","da","display"], body: async (Plot,hulls,da,display) => {
display(await(
Plot.plot({
        marks: [
          Plot.hull(hulls.flatMap(d => d), {
            x: "x",
            y: "y",
            z: "cluster",
            fill: "lightgray",
            fillOpacity: 0.1,
            stroke: "lightgray",
            curve: "catmull-rom",
          }),
          Plot.dot(da, {
            x: "x",
            y: "y",
            r: 2,
            fill: "cluster",
            title: d => `${d["cluster"]}: ${d["label"]}
Role: ${d["Role"]}

${d["DataVizNotUnderstood"]}`,
            tip: true
          }),
        ],
        width: 500,
        height: 500,
        margin: 20,
        color: { scheme: "cool" },
        y: { axis: null},
        x: { axis: null },
      })
))
}});

define({id: "80ad06eb", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(27, {description: "These responses confirm a long-standing belief I've personally held: that cleaning and preparing data is a huge part of data visualization work. This principle is part of the motivation for building Latent Scope, a robust process for adding structure to data so it becomes possible to visualize!", tableConfig, da, scope, hulls})
))
}});

define({id: "67b20c5d", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(28,{description: "These responses all seem like they would fit just as well in cluster 27.", tableConfig, da, scope, hulls})
))
}});

define({id: "ae80f216", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(3, {description: "Data viz takes time!", tableConfig, da, scope, hulls})
))
}});

define({id: "df7bfc52", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(14, {description: "Notice the conspicious lack of the word 'viz' in these responses. Otherwise they would fit well in Cluster 3.", tableConfig, da, scope, hulls})
))
}});

define({id: "b1aef65e", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(20, {description: "Again, these responses could be reasonably combined with Cluster 3 or 14, but as the label implies there is the added idea of complexity, details and intention added to many responses.", tableConfig, da, scope, hulls})
))
}});

define({id: "39d66148", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(21, {description: "Here is more time, but now we also have a lot more 'effort' mixed in.", tableConfig, da, scope, hulls})
))
}});

define({id: "21edfd7c", inline: true, inputs: ["clusterCard","tableConfig","da","scope","hulls","display"], body: async (clusterCard,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(11, {description: "Speaking of effort, these responses are all about effort and don't mention time explicitly.", tableConfig, da, scope, hulls})
))
}});

define({id: "0f29dbbb", inline: true, inputs: ["scope","display"], body: async (scope,display) => {
display(await(
scope.cluster_labels_lookup.length
))
}});

define({id: "92fb4788", inputs: ["view","Inputs","scope"], outputs: ["selcluster"], body: (view,Inputs,scope) => {
const selcluster = view(Inputs.select(scope.cluster_labels_lookup, { value: d => d.cluster, format: x => x.cluster + ": " + x.label, label: "Cluster:"}))
return {selcluster};
}});

define({id: "966b0f2d", inline: true, inputs: ["clusterCard","selcluster","tableConfig","da","scope","hulls","display"], body: async (clusterCard,selcluster,tableConfig,da,scope,hulls,display) => {
display(await(
clusterCard(selcluster.cluster, {description: "", tableConfig, da, scope, hulls})
))
}});

define({id: "7b2ff0a5", body: () => {
// -------------------------------------------------
}});

define({id: "8db63f16", outputs: ["tableConfig"], body: () => {
const tableConfig = { 
  columns: [
    "DataVizNotUnderstood",
    "Role",
  ],
  width: {
    "DataVizNotUnderstood": "70%",
  },
  rows: 12
}
return {tableConfig};
}});

define({id: "de076962", body: () => {
// const map = view(canvas)
}});

define({id: "08e9e9b6", inputs: ["tooltip"], outputs: ["tip"], body: (tooltip) => {
const tip = tooltip({})
return {tip};
}});

define({id: "b9443a04", body: () => {
// let hp = da[map.hovered[0]]
}});

define({id: "77220b31", body: () => {
// if(hp) {
//   // display the tooltip
//   // console.log("p, sel", p, selected)
//   tip.show(hp, map, `
//   <i>Cluster ${hp["cluster"]}: ${hp["label"]}</i>
//   <br/>
//   <span>Role: ${hp["Role"]}
//   <br/>
//   ${hp["DataVizNotUnderstood"]}
//   `)
// } else {
//   tip.hide()
// }
}});

define({id: "b0028f22", body: () => {
// const canvas = document.createElement("canvas")
}});

define({id: "520ae0fa", body: () => {
// let tableData = []
// if(map.selected.length > 0) {
//   // tableData = []
//   map.selected.forEach(i => tableData.push(da[i]))
// }
}});

define({id: "06bd66db", inputs: ["scope","da"], outputs: ["hulls"], body: (scope,da) => {
// calculate the hull points
const hulls = scope.cluster_labels_lookup.map(c => {
  return c.hull.map(idx => da.find(d => d.index === idx))
})
return {hulls};
}});

define({id: "7205427d", inputs: ["DuckDBClient","FileAttachment"], outputs: ["db"], body: (DuckDBClient,FileAttachment) => {
const db = DuckDBClient.of({
  scope: FileAttachment("./data/datavis-survey/scopes-001-input.parquet")
});
return {db};
}});

define({id: "0fe0d076", inputs: ["FileAttachment"], outputs: ["scope"], body: (FileAttachment) => {
const scope = FileAttachment("./data/datavis-survey/scopes-001.json").json()
return {scope};
}});

define({id: "bee957c8", inputs: ["db"], outputs: ["data"], body: (db) => {
// const rows = db.sql`SELECT * FROM input`
const data = db.sql`SELECT * FROM scope`
return {data};
}});

define({id: "0f267664", inputs: ["data"], outputs: ["da"], body: (data) => {
const da = data.toArray().map(d => d.toJSON())
return {da};
}});

define({id: "5551e850", inputs: ["da","scope","hulls"], body: (da,scope,hulls) => {
console.log("data!", da)
console.log("scope!", scope)
console.log("hulls!", hulls)
}});

define({id: "d89547a4", outputs: ["scatter","hull","tooltip","clusterCard"], body: async () => {
const [{scatter}, {hull}, {tooltip}, {clusterCard}] = await Promise.all([import("./_import/components/scatter.e6a504c8.js"), import("./_import/components/hull.f981bcf2.js"), import("./_import/components/tooltip.c593267a.js"), import("./_import/components/clusterCard.eba8a284.js")]);

return {scatter,hull,tooltip,clusterCard};
}});

define({id: "5f76811e", outputs: ["isMobileDevice"], body: () => {
const isMobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
return {isMobileDevice};
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Latent Scope</a></li>
  </ol>
  <ol>
    <section>
      <summary>Guides</summary>
      <ol>
    <li class="observablehq-link"><a href="./install-and-config">Install &amp; Configure</a></li>
    <li class="observablehq-link"><a href="./your-first-scope">Your First Scope</a></li>
    <li class="observablehq-link"><a href="./explore-and-curate">Explore and Curate</a></li>
    <li class="observablehq-link"><a href="./exporting-data">Exporting data</a></li>
      </ol>
    </section>
    <section class="observablehq-section-active">
      <summary>Example Analysis</summary>
      <ol>
    <li class="observablehq-link observablehq-link-active"><a href="./datavis-survey">Datavis Survey</a></li>
    <li class="observablehq-link"><a href="./plot-issues">GitHub Issues &amp; PRs</a></li>
    <li class="observablehq-link"><a href="./enjalot-tweets">enjalot&#x27;s tweets</a></li>
    <li class="observablehq-link"><a href="./us-federal-laws">US Federal Laws</a></li>
      </ol>
    </section>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type), h2:first-child, :not(h1) + h2">
<nav>
</nav>
</aside>
<div id="observablehq-center">
<header id="observablehq-header">

  <!-- Google tag (gtag.js) -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W8EM95KSJZ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-W8EM95KSJZ');
  </script>
  
  <link rel="stylesheet" type="text/css" href="./_file/index.0dcd799c.css">
  <div style="display: flex; align-items: center; gap: 0.5rem; height: 2.2rem; margin: -1.5rem -2rem 2rem -2rem; padding: 0.5rem 2rem; border-bottom: solid 1px var(--theme-foreground-faintest); font: 500 16px var(--sans-serif);">
    <div style="display: flex; flex-grow: 1; justify-content: space-between; align-items: baseline;">
      <a href="./">
        Latent Scope
      </a>
      <span style="display: flex; align-items: baseline; gap: 0.5rem; font-size: 14px;">
        <a target="_blank" href="https://github.com/enjalot/latent-scope" rel="noopener noreferrer">GitHub</a>
        <a target="_blank" href="https://pypi.org/project/latentscope/" rel="noopener noreferrer">Python Module</a>
        <a target="_blank" href="https://discord.gg/x7NvpnM4pY" rel="noopener noreferrer">Discord</a>
        
        <a target="_blank" href="https://github.com/enjalot/latent-scope-observable-examples" rel="noopener noreferrer">Examples Source</a>
      </span>
    </div>
  </div>
</header>
<main id="observablehq-main" class="observablehq">
<h1>Survey Analysis Example</h1>
<!-- <h2><a href="https://gist.github.com/curran/003cca0643e9947162359268821415f5">Source data</a>. Generated with <a href="https://github.com/enjalot/latent-scope">Latent Scope</a></h2> -->
<p>A common source of valuable unstructured text data is the free response questions often asked in surveys. This data is of course difficult to work with, as typical techniques for finding insights in surveys focus on structured data like the answers to multiple choice questions.</p>
<p>The data used to setup <a href="your-first-scope">your first scope</a> is in fact the 765 responses to the question:
<em>"What do you think people you work with just don't get about the data visualization work that you do?"</em></p>
<p>Let's take a look at how Latent Scope can help us pull out some insight from those responses by examining the clusters it's identified. Note that this page is using the exported scope from the <a href="your-first-scope">your first scope</a> guide, and much of this analysis could be done within the tool.</p>
<p>Before we get to the fun visualizations, let's take a look at the input data. The data is an extract of the <a href="https://gist.github.com/curran/003cca0643e9947162359268821415f5" target="_blank" rel="noopener noreferrer">full survey</a>, where the answer to the question is stored in <code>DataVizNotUnderstood</code>, and we also have multiple-choice answer of the respondant's <code>Role</code>:</p>
<div class="static-table">
  <span id="cell-1b1151e3" class="observablehq--loading"></span>
</div>
<p>As you can see, it's not very straightforward to pick out patterns just by scrolling through the text, so let's take a look at what Latent Scope gave us:</p>
<div id="cell-9577b65f" class="observablehq observablehq--block observablehq--loading"></div>
<p>The map is created by going through the 4 step process in Latent scope:</p>
<ol>
<li>Embed - run each piece of text through an embedding model</li>
<li>Project - run the high-dimensional embeddings through UMAP</li>
<li>Cluster - run the 2-dimensional UMAP coordinates through HDBSCAN</li>
<li>Label - ask an LLM to create a label by summarizing a list of text taken from each cluster</li>
</ol>
<p>What the process gives us is a workable categorization of the text data based on the patterns captured by the embedding model and the labeling of the LLM.
Of course these automated steps are never perfect, so Latent Scope is designed to both let you tweak the parameters of each step as well as manually re-categorize data once the process is finished. For more details see the <a href="explore-and-curate">explore and curate guide</a>.</p>
<p>Let's take a closer look at some of the clusters we got, starting with my favorite (because it's so true!)</p>
<div>
  <span id="cell-80ad06eb" class="observablehq--loading"></span>
</div>
<p>As I mentioned, the process isn't perfect, and here we see a cluster that could have easily been combined with Cluster 27:</p>
<div>
  <span id="cell-67b20c5d" class="observablehq--loading"></span>
</div>
<p>In fact, I did use the explore tool to combine a couple of clusters into this one:</p>
<div>
  <span id="cell-ae80f216" class="observablehq--loading"></span>
</div>
<p>And we can see that how much time it takes to make data visualizations is a common response, there is this other large cluster:</p>
<div>
  <span id="cell-df7bfc52" class="observablehq--loading"></span>
</div>
<p>As you can see, the embeddings (and UMAP, and clustering) may separate text based on different concepts. The last two clusters are conceptually very similar with the main difference being that most people used the word "viz" in one cluster and not in the other. I find it quite amazing that this level of separation is possible, but it may sometimes not be what you want to separate.</p>
<p>The theme of time and effort is expressed further in other clusters:</p>
<div>
  <span id="cell-b1aef65e" class="observablehq--loading"></span>
</div>
<div>
  <span id="cell-39d66148" class="observablehq--loading"></span>
</div>
<div>
  <span id="cell-21edfd7c" class="observablehq--loading"></span>
</div>
<p>Whew! Data visualization certainly takes a lot of time and effort! There are many more clusters to explore (<span id="cell-0f29dbbb" class="observablehq--loading"></span> in fact), instead of listing them all out let's end with a little interactive choice:</p>
<div id="cell-92fb4788" class="observablehq observablehq--block"></div>
<div>
  <span id="cell-966b0f2d" class="observablehq--loading"></span>
</div>
<p>What are you waiting for? Try <a href="https://github.com/enjalot/latent-scope" target="_blank" rel="noopener noreferrer">Latent Scope</a> out on your own data!</p>
<div id="cell-7b2ff0a5" class="observablehq observablehq--block"></div>
<div id="cell-8db63f16" class="observablehq observablehq--block"></div>
<div id="cell-de076962" class="observablehq observablehq--block"></div>
<div id="cell-08e9e9b6" class="observablehq observablehq--block"></div>
<div id="cell-b9443a04" class="observablehq observablehq--block"></div>
<div id="cell-77220b31" class="observablehq observablehq--block"></div>
<div id="cell-b0028f22" class="observablehq observablehq--block"></div>
<div id="cell-520ae0fa" class="observablehq observablehq--block"></div>
<div id="cell-06bd66db" class="observablehq observablehq--block"></div>
<div id="cell-7205427d" class="observablehq observablehq--block"></div>
<div id="cell-0fe0d076" class="observablehq observablehq--block"></div>
<div id="cell-bee957c8" class="observablehq observablehq--block"></div>
<div id="cell-0f267664" class="observablehq observablehq--block"></div>
<div id="cell-5551e850" class="observablehq observablehq--block"></div>
<div id="cell-d89547a4" class="observablehq observablehq--block"></div>
<div id="cell-5f76811e" class="observablehq observablehq--block"></div>
</main>
<footer id="observablehq-footer">
<nav><a rel="prev" href="./exporting-data"><span>Exporting data</span></a><a rel="next" href="./plot-issues"><span>GitHub Issues &amp; PRs</span></a></nav>
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-10-03T10:10:33">Oct 3, 2024</a>.</div>
</footer>
</div>
